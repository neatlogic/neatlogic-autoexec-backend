.\" Automatically generated by Pod::Man 2.27 (Pod::Simple 3.28)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{
.    if \nF \{
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "SOAP::Server 3"
.TH SOAP::Server 3 "2021-07-27" "perl v5.16.3" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
SOAP::Server \- provides the basic framework for the transport\-specific server classes to build upon
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The SOAP::Server class provides the basic framework for the transport-specific server classes to build upon. Note that in none of the code examples provided with SOAP::Lite is this class used directly. Instead, it is designed to be a superclass within more specific implementation classes. The methods provided by SOAP::Server itself are:
.SH "METHODS"
.IX Header "METHODS"
.IP "new(optional key/value pairs)" 4
.IX Item "new(optional key/value pairs)"
.Vb 1
\&    $server = SOAP::Server\->new(%options);
.Ve
.Sp
Creates a new object of the class. Various default instance values are set up, and like many of the constructors in this module, most of the class methods described here may be passed in the construction call by giving the name followed by the parameter (or an array reference if there are multiple parameters).
.IP "action(optional new value)" 4
.IX Item "action(optional new value)"
.Vb 1
\&    $action = $server\->action
.Ve
.Sp
Retrieves or sets the value of the action attribute on the server object. This attribute is used when mapping the request to an appropriate namespace or routine. For example, the \s-1HTTP\s0 library sets the attribute to the value of the SOAPAction header when processing of the request begins, so that the find_target method described later may retrieve the value to match it against the server's configuration. Returns the object itself when setting the attribute.
.IP "myuri(optional new value)" 4
.IX Item "myuri(optional new value)"
.Vb 1
\&    $server\->myuri("http://localhost:9000/SOAP");
.Ve
.Sp
Gets or sets the myuri attribute. This specifies the specific \s-1URI\s0 that the server is answering requests to (which may be different from the value specified in action or in the SOAPAction header).
.IP "serializer(optional new value)" 4
.IX Item "serializer(optional new value)"
.PD 0
.IP "deserializer(optional new value)" 4
.IX Item "deserializer(optional new value)"
.PD
.Vb 2
\&    $serializer = $server\->serializer;
\&    $server\->deserializer($new_deser_obj);
.Ve
.Sp
As with the client objects, these methods provide direct access to the serialization and deserialization objects the server object uses to transform input and output from and to \s-1XML.\s0 There is generally little or no need to explicitly set these to new values.
.IP "options(optional new value)" 4
.IX Item "options(optional new value)"
.Vb 1
\&    $server\->options({compress_threshold => 10000});
.Ve
.Sp
Sets (or retrieves) the current server options as a hash-table  reference. At present, only one option is used within the SOAP::Lite libraries themselves:
.RS 4
.IP "compress_threshold" 4
.IX Item "compress_threshold"
The value of this option is expected to be a numerical value. If set, and if the Compress::Zlib library is available to use, messages whose size in bytes exceeds this value are compressed for transmission. Both
ends of the conversation have to support this and have it enabled.
.RE
.RS 4
.Sp
Other options may be defined and passed around using this mechanism. Note that setting the options using this accessor requires a full hash reference be passed. To set just one or a few values, retrieve the current reference value and use it to set the key(s).
.RE
.IP "dispatch_with(optional new value)" 4
.IX Item "dispatch_with(optional new value)"
.Vb 1
\&    $server\->dispatch_with($new_table);
.Ve
.Sp
Represents one of two ways in which a SOAP::Server (or derived) object may specify mappings of incoming requests to server-side subroutines or namespaces. The value of the attribute is a hash-table reference. To set the attribute, you must pass a new hash reference. The hash table's keys are \s-1URI\s0 strings (literal URIs or the potential values of the SOAPAction header), and the corresponding values are one of a class name or an object reference. Requests that come in for a \s-1URI\s0 found in the table are routed to the specified class or through the specified object.
.IP "dispatch_to(optional list of new values)" 4
.IX Item "dispatch_to(optional list of new values)"
.Vb 1
\&    $server\->dispatch_to($dir, \*(AqModule\*(Aq, \*(AqMod::meth\*(Aq);
.Ve
.Sp
This is the more traditional way to specify modules and packages for routing requests. This is also an accessor, but it returns a list of values when called with no arguments (rather than a single one). Each item in the list of values passed to this method is expected to be one of four things:
.RS 4
.IP "\fIDirectory path\fR" 4
.IX Item "Directory path"
If the value is a directory path, all modules located in that path are available for remote use.
.IP "\fIPackage name\fR" 4
.IX Item "Package name"
When the value is a package name (without including a specific method name), all routines within the package are available remotely.
.IP "\fIFully qualified method name\fR" 4
.IX Item "Fully qualified method name"
Alternately, when the value is a package-qualified name of a subroutine or method, that specific routine is made available. This allows the server to make selected methods available without opening the entire package.
.IP "\fIObject reference\fR" 4
.IX Item "Object reference"
If the value is an object reference, the object itself routes the request.
.Sp
The list of values held by the dispatch_to table are compared only after the \s-1URI\s0 mapping table from the dispatch_with attribute has been consulted. If the request's \s-1URI\s0 or SOAPAction header don't map to a specific configuration, the path specified by the action header (or in absence, the \s-1URI\s0) is converted to a package name and compared against this set of values.
.RE
.RS 4
.RE
.IP "objects_by_reference(optional list of new values)" 4
.IX Item "objects_by_reference(optional list of new values)"
.Vb 1
\&    $server\->objects_by_reference(qw(My:: Class));
.Ve
.Sp
This also returns a list of values when retrieving the current attribute value,
as opposed to a single value.
.Sp
This method doesn't directly specify classes for request routing so much as it
modifies the behavior of the routing for the specified classes. The classes that
are given as arguments to this method are marked to be treated as producing
persistent objects. The client is given an object representation that contains
just a handle on a local object with a default persistence of 600 idle seconds.
Each operation on the object resets the idle timer to zero. This facility is
considered experimental in the current version of SOAP::Lite.
.Sp
A global variable/\*(L"constant\*(R" allows developers to specify the amount of time
an object will be persisted. The default value is 600 idle seconds. This value
can be changed using the following code:
.Sp
.Vb 1
\&  $SOAP::Constants::OBJS_BY_REF_KEEPALIVE = 1000;
.Ve
.IP "on_action(optional new value)" 4
.IX Item "on_action(optional new value)"
.Vb 1
\&    $server\->on_action(sub { ...new code });
.Ve
.Sp
Gets or sets the reference to a subroutine that is used for executing the on_action hook. Where the client code uses this hook to construct the action-request data (such as for a SOAPAction header), the server uses the on_action hook to do any last-minute tests on the request itself, before it gets routed to a final destination. When called, the hook routine is passed three arguments:
.RS 4
.IP "action" 4
.IX Item "action"
The action \s-1URI\s0 itself, retrieved from the action method described earlier.
.IP "method_uri" 4
.IX Item "method_uri"
The \s-1URI\s0 of the \s-1XML\s0 namespace the method name is labeled with.
.IP "method_name" 4
.IX Item "method_name"
The name of the method being called by the request.
.RE
.RS 4
.RE
.IP "on_dispatch(optional new value)" 4
.IX Item "on_dispatch(optional new value)"
.Vb 1
\&    ($uri, $name) = $server\->on_dispatch\->($request);
.Ve
.Sp
Gets or sets the subroutine reference used for the on_dispatch hook. This hook is called at the start of the request-routing phase and is given a single argument when called:
.RS 4
.IP "request" 4
.IX Item "request"
An object of the \s-1SOAP::SOM\s0 class, containing the deserialized request from the client.
.RE
.RS 4
.RE
.IP "find_target" 4
.IX Item "find_target"
.Vb 1
\&    ($class, $uri, $name) = $server\->find_target($req)
.Ve
.Sp
Taking as its argument an object of the \s-1SOAP::SOM\s0 class that contains the deserialized request, this method returns a three-element list describing the method that is to be called. The elements are:
.RS 4
.IP "class" 4
.IX Item "class"
The class into which the method call should be made. This may come back as either a string or an objectreference, if the dispatching is configured using an object instance.
.IP "uri" 4
.IX Item "uri"
The \s-1URN\s0 associated with the request method. This is the value that was used when configuring the method routing on the server object.
.IP "name" 4
.IX Item "name"
The name of the method to call.
.RE
.RS 4
.RE
.IP "handle" 4
.IX Item "handle"
.Vb 1
\&    $server\->handle($request_text);
.Ve
.Sp
Implements the main functionality of the serving process, in which the server takes an incoming request and dispatches it to the correct server-side subroutine. The parameter taken as input is either plain \s-1XML\s0 or MIME-encoded content (if MIME-encoding support is enabled).
.IP "make_fault" 4
.IX Item "make_fault"
.Vb 1
\&    return $server\->makefault($code, $message);
.Ve
.Sp
Creates a SOAP::Fault object from the data passed in. The order of arguments is: code, message, detail, actor. The first two are required (because they must be present in all faults), but the last two may be omitted unless needed.
.SS "SOAP::Server::Parameters"
.IX Subsection "SOAP::Server::Parameters"
This class provides two methods, but the primary purpose from the developer's point of view is to allow classes that a \s-1SOAP\s0 server exposes to inherit from it. When a class inherits from the SOAP::Server::Parameters class, the list of parameters passed to a called method includes the deserialized request in the form of a \s-1SOAP::SOM\s0 object. This parameter is passed at the end of the arguments list, giving methods the option of ignoring it unless it is needed.
.PP
The class provides two subroutines (not methods), for retrieving parameters from the \s-1SOAP::SOM\s0 object. These are designed to be called without an object reference in the parameter list, but with an array reference instead (as the first parameter). The remainder of the arguments list is expected to be the list from the method-call itself, including the \s-1SOAP::SOM\s0 object at the end of the list. The routines may be useful to understand if an application wishes to subclass SOAP::Server::Parameters and inherit from the new class instead.
.IP "byNameOrOrder(order, parameter list, envelope)" 4
.IX Item "byNameOrOrder(order, parameter list, envelope)"
.Vb 1
\&    @args = SOAP::Server::Parameters::byNameOrOrder ([qw(a b)], @_);
.Ve
.Sp
Using the list of argument names passed in the initial argument as an array reference, this routine returns a list of the parameter values for the parameters matching those names, in that order. If none of the names given in the initial array-reference exist in the parameter list, the values are returned in the order in which they already appear within the list of parameters. In this case, the number of returned values may differ from the length of the requested-parameters list.
.IP "byName(order, parameter list, envelope)" 4
.IX Item "byName(order, parameter list, envelope)"
.Vb 1
\&    @args = SOAP::Server::Parameters::byName ([qw(a b c)], @_);
.Ve
.Sp
Acts in a similar manner to the previous, with the difference that it always returns as many values as requested, even if some (or all) don't exist. Parameters that don't exist in the parameter list are returned as undef values.
.PP
\fI\s-1EXAMPLE\s0\fR
.IX Subsection "EXAMPLE"
.PP
The following is an example \s-1CGI\s0 based Web Service that utilizes a Perl module that inherits from the \f(CW\*(C`SOAP::Server::Parameters\*(C'\fR class. This allows the methods of that class to access its input by name.
.PP
.Vb 10
\&    #!/usr/bin/perl
\&    use SOAP::Transport::HTTP;
\&    SOAP::Transport::HTTP::CGI
\&      \->dispatch_to(\*(AqC2FService\*(Aq)
\&      \->handle;
\&    BEGIN {
\&      package C2FService;
\&      use vars qw(@ISA);
\&      @ISA = qw(Exporter SOAP::Server::Parameters);
\&      use SOAP::Lite;
\&      sub c2f {
\&        my $self = shift;
\&        my $envelope = pop;
\&        my $temp = $envelope\->dataof("//c2f/temperature");
\&        return SOAP::Data\->name(\*(AqconvertedTemp\*(Aq => (((9/5)*($temp\->value)) + 32));
\&      }
\&    }
.Ve
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\s-1SOAP::SOM\s0, SOAP::Transport::HTTP
.SH "ACKNOWLEDGEMENTS"
.IX Header "ACKNOWLEDGEMENTS"
Special thanks to O'Reilly publishing which has graciously allowed SOAP::Lite to republish and redistribute large excerpts from \fIProgramming Web Services with Perl\fR, mainly the SOAP::Lite reference found in Appendix B.
.SH "COPYRIGHT"
.IX Header "COPYRIGHT"
Copyright (C) 2000\-2004 Paul Kulchenko. All rights reserved.
.PP
This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.
.SH "AUTHORS"
.IX Header "AUTHORS"
Paul Kulchenko (paulclinger@yahoo.com)
.PP
Randy J. Ray (rjray@blackperl.com)
.PP
Byrne Reese (byrne@majordojo.com)
